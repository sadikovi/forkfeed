(function(){var t,e=[].slice,n=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=function(){function t(){}return t.prototype.createElement=function(t,e,n,r,i){var o;return t?(o=document.createElement(t),n&&(o.className=n),e&&(o.id=e),r&&(o.innerHTML=r),i&&i.appendChild(o),o):!1},t.prototype.clear=function(t){return t?t.innerHTML="":void 0},t.prototype.addEventListener=function(t,e,n){return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n},t.prototype.removeEventListener=function(t,e,n){return t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null},t.prototype.addClass=function(){var t,r,i,o,s;return i=arguments[0],r=2<=arguments.length?e.call(arguments,1):[],t=i.className.trim(),t=t?t.split(" "):[],o=t.concat(function(){var e,i,o;for(o=[],e=0,i=r.length;i>e;e++)s=r[e],s&&n.call(t,s)<0&&o.push(s);return o}()),i.className=o.join(" ")},t.prototype.removeClass=function(){var t,r,i,o;return i=arguments[0],r=2<=arguments.length?e.call(arguments,1):[],t=i.className.split(" "),i.className=function(){var e,i,s;for(s=[],e=0,i=t.length;i>e;e++)o=t[e],n.call(r,o)<0&&s.push(o);return s}().join(" ")},t.prototype.hasClass=function(t,e){return n.call(t.className.split(" "),e)>=0},t.prototype.quote=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16)})},t.prototype.unquote=function(t){return decodeURIComponent(t)},t.prototype.isArray=function(t){return Array.isArray(t)||"[object Array]"==={}.toString.call(t)},t.prototype.randomid=function(){return(""+Math.random()).split(".")[1]},t.prototype.jsonOrElse=function(t,e){var n,r;null==e&&(e=null);try{r=JSON.parse(t)}catch(i){n=i,r=e}return r},t.prototype.intOrElse=function(t,e){var n;return null==e&&(e=-1),n=parseInt(t,10),NaN!==n?n:e},t.prototype.humanReadableTime=function(t,e){var n,r,i,o;return null==e&&(e="en-nz"),o=[new Date,new Date(t)],i=o[0],n=o[1],r=(i.getTime()-n.getTime())/1e3,r>0&&60>r?"less than a minute ago":r>=60&&3600>r?Math.floor(r/60)+" minutes ago":r>=3600&&86400>r?Math.floor(r/60/60)+" hours ago":""+n.toLocaleString(e)},t.prototype.timestampToDate=function(t,e){var n;return null==e&&(e="en-nz"),n=new Date(t),""+n.toLocaleString(e)},t.prototype.humanReadableDiff=function(t){var e,n,r;return r=Math.floor(t/1e3),e=Math.floor(r/3600),n=Math.floor(r/60),e>0?e+"hrs "+n%60+"min":n>0?n+"min "+r%60+"sec":r+"sec ("+t+")"},t.prototype.windowParameters=function(){var t,e,n,r,i,o,s,u,a,l,c;if(!(window&&window.location&&window.location.search))throw new Error("Window.location is not set properly");for(o=null!=(c=window.location.search)?c.trim():void 0,t=function(){var t,n,r,i;for(r=o.split("&"),i=[],t=0,n=r.length;n>t;t++)e=r[t],i.push(e.split("=",2));return i}(),n={},a=0,l=t.length;l>a;a++)r=t[a],s=0===r[0].indexOf("?")?r[0].substring(1):r[0],i=this.unquote(s),u=r[1]?this.unquote(r[1]):null,n[i]=u;return n},t}(),null==this.util&&(this.util=new t)}).call(this),function(){var t;t=function(){function t(){}return t.prototype.sendrequest=function(t,e,n,r,i,o){var s,u,a;a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a.onreadystatechange=function(){var t;return 4===a.readyState?200<=(t=a.status)&&300>t?"function"==typeof i?i(a.status,a.responseText):void 0:"function"==typeof o?o(a.status,a.responseText):void 0:void 0},a.open(t,e,!0);for(s in n)u=n[s],a.setRequestHeader(s,u);return a.send(r)},t.prototype.syncrequest=function(t,e,n,r){var i,o,s;s=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),s.open(t,e,!1);for(i in n)o=n[i],s.setRequestHeader(i,o);return s.send(r)},t}(),null==this.loader&&(this.loader=new t)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};t=function(){function t(){this.parseMapForParent=e(this.parseMapForParent,this)}return t.prototype.createElement=function(t,e){var n;return n=document.createElement(t),e&&e.appendChild(n),n},t.prototype.addEventListener=function(t,e,n){return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n},t.prototype.parseMapForParent=function(t,e){var n,r,i,o,s,u;if(!t)return!1;if(i={type:"type",cls:"cls",id:"id",title:"title",href:"href",target:"target",src:"src",inputvalue:"inputvalue",inputtype:"inputtype",placeholder:"placeholder",optionselected:"optionselected",children:"children",text_last:"text_last",onclick:"onclick",onkeyup:"onkeyup",arialabel:"arialabel"},"nodeName"in t)e&&e.appendChild(t);else if(i.type in t)n=this.createElement(t[i.type],e),i.id in t&&(n.id=""+t[i.id]),i.cls in t&&(n.className=""+t[i.cls]),i.href in t&&(n.href=""+t[i.href]),i.target in t&&(n.target=""+t[i.target]),i.src in t&&(n.src=""+t[i.src]),i.inputvalue in t&&(n.value=""+t[i.inputvalue]),i.inputtype in t&&(n.type=""+t[i.inputtype]),i.placeholder in t&&(n.placeholder=""+t[i.placeholder]),i.optionselected in t&&(n.selected=t[i.optionselected]),i.arialabel in t&&n.setAttribute("aria-label",t[i.arialabel]),i.onclick in t&&t[i.onclick]&&this.addEventListener(n,"click",function(e){return t[i.onclick].call(this,e)}),i.onkeyup in t&&t[i.onkeyup]&&this.addEventListener(n,"keyup",function(e){return t[i.onkeyup].call(this,e)}),i.title in t&&(o=document.createTextNode(""+t[i.title]),i.children in t?(length in t||(t[i.children]=[t[i.children]]),i.text_last in t&&t[i.text_last]?t[i.children].push(o):t[i.children].unshift(o)):t[i.children]=[o]),i.children in t&&this.parseMapForParent(t[i.children],n);else for(s=0,u=t.length;u>s;s++)r=t[s],this.parseMapForParent(r,e);return n},t}(),null==this.mapper&&(this.mapper=new t)}.call(this),function(){var t,e;t=function(){function t(e,n,r,i,o,s){var u;if(this.elem=e,this.onDidFinishEdit=n,this.oktext=null!=r?r:"Save",this.canceltext=null!=i?i:"Cancel",this.placeholder=null!=o?o:"",this.displayvalue=null!=s?s:!0,!this.elem||this.elem.nodeType!==Node.ELEMENT_NODE||!this.hasDataAttribute(this.elem))throw new Error("Wrong element");if(this.assets={},u=[null,null],this.assets.texter=u[0],this.assets.trigger=u[1],this.discover(this.elem),!this.assets.texter||!this.assets.trigger)throw new Error("Insufficient structure");t._util.addEventListener(this.assets.trigger,"click",function(t){return function(e){return t.showPanel(),e.preventDefault()}}(this)),this.on=!1}return t.prototype.getAttribute=function(t){return t.getAttribute("data-attr")},t.prototype.hasDataAttribute=function(t){return"fast-editor"===this.getAttribute(t)},t.prototype.hasTriggerAttribute=function(t){return"fast-editor-trigger"===this.getAttribute(t)},t.prototype.hasTextAttribute=function(t){return"fast-editor-texter"===this.getAttribute(t)},t.prototype.discover=function(t){var e,n,r,i,o;if(!t||!t.childNodes)return!1;for(i=t.childNodes,o=[],n=0,r=i.length;r>n;n++)e=i[n],e&&e.nodeType===Node.ELEMENT_NODE?this.hasTriggerAttribute(e)?o.push(this.assets.trigger=e):this.hasTextAttribute(e)?o.push(this.assets.texter=e):o.push(this.discover(e)):o.push(void 0);return o},t.prototype.showPanel=function(n){return this.on?!1:(n=n||""+this.assets.texter.textContent,this.panel=new e(n,this.placeholder,this.oktext,this.canceltext),this.assets.texter.innerHTML="",this.assets.texter.appendChild(this.panel.html()),this.assets.trigger.style.display="none",t._util.addEventListener(this.panel.ok,"click",function(t){return function(e){var n;return n=t.panel.texter.value,"function"==typeof t.hidePanel&&t.hidePanel(n),"function"==typeof t.onDidFinishEdit&&t.onDidFinishEdit(!0,n),e.preventDefault()}}(this)),t._util.addEventListener(this.panel.ko,"click",function(t){return function(e){return"function"==typeof t.hidePanel&&t.hidePanel(),"function"==typeof t.onDidFinishEdit&&t.onDidFinishEdit(!1),e.preventDefault()}}(this)),this.on=!0)},t.prototype.hidePanel=function(t){var e;return this.on?(this.assets.texter.textContent=null!=(e=this.displayvalue?t:null)?e:this.panel.initvalue,this.panel=null,this.assets.trigger.style.display="",this.on=!1):!1},t}(),e=function(){function e(t,e,n,r){var i;this.initvalue=t,this.placeholder=null!=e?e:"",this.oktext=null!=n?n:"Save",this.canceltext=null!=r?r:"Cancel",this.initvalue=this.initvalue?this.initvalue.trim():"",i=[this.submit(),this.cancel(),this.input(this.initvalue)],this.ok=i[0],this.ko=i[1],this.texter=i[2]}return e.prototype.input=function(e){var n,r;return n=document.createElement("input"),n.setAttribute("placeholder",""+this.placeholder),r=["text",""+e],n.type=r[0],n.value=r[1],t._util.addClass(n,"form-control","short"),n},e.prototype.submit=function(){var e;return e=document.createElement("div"),e.innerHTML=""+this.oktext,t._util.addClass(e,"btn","btn-success"),e},e.prototype.cancel=function(){var e;return e=document.createElement("div"),e.innerHTML=""+this.canceltext,t._util.addClass(e,"btn"),e},e.prototype.html=function(){var e,n,r,i,o,s,u,a,l;for(i=document.createElement("div"),t._util.addClass(i,"breadcrumb"),n=document.createElement("div"),t._util.addClass(n,"section"),n.appendChild(this.texter),o=document.createElement("div"),t._util.addClass(o,"section"),o.appendChild(this.ok),e=document.createElement("div"),t._util.addClass(e,"section"),e.appendChild(this.ko),s=function(){var e;return e=document.createElement("div"),t._util.addClass(e,"separator"),e},l=[n,s(),o,s(),e],u=0,a=l.length;a>u;u++)r=l[u],i.appendChild(r);return i},e}(),t._util=this.util,null==this.FastEditor&&(this.FastEditor=t)}.call(this),function(){var t,e,n,r,i,o=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;r=this.loader,i=this.util,t=function(){function t(){}return t.prototype.doRequest=function(t,e,n,r,o){var s,u,a;return s=t.toLowerCase(),o&&"get"===s?(r=r+"?"+function(){var t;t=[];for(u in o)a=o[u],t.push(i.quote(u)+"="+i.quote(a));return t}().join("&"),o=null):"post"===s&&(o=JSON.stringify(o)),"function"==typeof e&&e(),loader.sendrequest(s,r,{},o,function(t,e){var r;return r=util.jsonOrElse(e),"function"==typeof n?n(!!r,r):void 0},function(t,e){var r;return r=util.jsonOrElse(e),"function"==typeof n?n(!1,r):void 0})},t.prototype.doGet=function(t,e,n,r){return null==r&&(r=null),this.doRequest("get",t,e,n,r)},t.prototype.doPost=function(t,e,n,r){return this.doRequest("post",t,e,n,r)},t}(),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.create=function(t,e,n,r){return this.doGet(n,r,"/api/v1/feed/create",{type:""+t,item:""+e})},e.prototype["delete"]=function(t,e,n){return this.doGet(e,n,"/api/v1/feed/delete",{itemid:""+t})},e}(t),null==this.FeedApi&&(this.FeedApi=n),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.githubEvent=function(t,e,n){return this.doGet(e,n,"https://api.github.com/repos/"+t+"/events")},e}(t),null==this.EventsApi&&(this.EventsApi=e)}.call(this),function(){var t,e,n,r,i,o,s,u,a,l,c;if(c=this.util,s=new this.FeedApi,u=new this.EventsApi,t=document.getElementById("forkfeed-add-repository"),e=document.getElementById("forkfeed-add-rss-feed"),o=document.getElementById("forkfeed-menu"),!(e&&t&&o))throw new Error("Required elements are not found on page");for(new this.FastEditor(t,function(t,e){return t?s.create("REP",e,function(){return console.log("before")},function(t,e){return console.log(t,e)}):void 0},"Add","Cancel","Add owner/repository",!1),new this.FastEditor(e,function(t,e){return t?s.create("RSS",e,function(){return console.log("before")},function(t,e){return console.log(t,e)}):void 0},"Add","Cancel","Add rss feed url",!1),i=o.getElementsByTagName("*"),a=0,l=i.length;l>a;a++)r=i[a],"del"===r.getAttribute("daction")?c.addEventListener(r,"click",function(t){var e;return e=this.getAttribute("dkey"),s["delete"](e,function(){return console.log("before delete")},function(t,e){return console.log(t,e)}),t.stopPropagation(),t.preventDefault()}):"load"===r.getAttribute("daction")&&(n=r.getAttribute("dtype").toLowerCase(),"rep"===n&&c.addEventListener(r,"click",function(t){var e;return e=this.getAttribute("dlink"),u.githubEvent(e,function(){return console.log("before")},function(t,e){return console.log(t,e)})}),"rss"===n&&console.log("RSS feed is not supported"))}.call(this);